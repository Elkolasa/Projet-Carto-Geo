<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Livre en ligne</title>

<style>
* { margin: 0; padding: 0; box-sizing: border-box; }

body {
    font-family: sans-serif;
    background-color: #f2f2f2;
    display: flex;
    justify-content: center;
    align-items: center;
    height: 100vh;
    overflow: hidden;
}

.book-container {
    width: 80vw;
    max-width: 600px;
    aspect-ratio: 210 / 297;
    position: relative;
    overflow: hidden;
    box-shadow: 0 10px 20px rgba(0,0,0,0.3);
}

.page {
    width: 100%;
    height: 100%;
    position: absolute;
    top: 0;
    left: 0;

    background-size: contain;
    background-position: center;
    background-repeat: no-repeat;

    transform: translateX(100%); /* pages stockées à droite */
    transition: transform 0.45s ease-in-out;
}

.page.active {
    transform: translateX(0);
}

.page.go-left { transform: translateX(-100%); }
.page.go-right { transform: translateX(100%); }
</style>
</head>
<body>

<div class="book-container">
    <div class="page active" style="background-image: url('Images/Couverture.png');"></div>
    <div class="page" style="background-image: url('Images/page2.png');"></div>
    <div class="page" style="background-image: url('Images/page3.png');"></div>
    <div class="page" style="background-image: url('Images/page4.png');"></div>
</div>

<script>
const pages = document.querySelectorAll(".page");
let current = 0;

function resetPageClasses(p) {
    p.classList.remove("active", "go-left", "go-right");
}

function showPage(target) {
    if (target === current) return;

    const forward = target > current; // avance dans le livre ?

    const oldPage = pages[current];
    const newPage = pages[target];

    // Reset future page
    resetPageClasses(newPage);

    // Page qui sort
    oldPage.classList.remove("active");
    oldPage.classList.add(forward ? "go-left" : "go-right");

    // Positionner la nouvelle page au bon côté
    newPage.style.transform = forward ? "translateX(100%)" : "translateX(-100%)";
    void newPage.offsetWidth; // reflow pour appliquer l'anim

    // Page qui entre
    newPage.classList.add("active");

    // Une fois la transition FINIE → reset pour pouvoir revenir
    oldPage.addEventListener("transitionend", function handler() {
        resetPageClasses(oldPage);
        oldPage.style.transform = "translateX(100%)"; // stockage à droite
        oldPage.removeEventListener("transitionend", handler);
    });

    current = target;
}

// Scroll
let lock = false;
window.addEventListener("wheel", e => {
    if (lock) return;
    lock = true;

    if (e.deltaY > 0 && current < pages.length - 1) showPage(current + 1);
    else if (e.deltaY < 0 && current > 0) showPage(current - 1);

    setTimeout(() => lock = false, 500);
});

// Flèches
window.addEventListener("keydown", e => {
    if (e.key === "ArrowRight" && current < pages.length - 1) showPage(current + 1);
    if (e.key === "ArrowLeft" && current > 0) showPage(current - 1);
});
</script>

</body>
</html>
